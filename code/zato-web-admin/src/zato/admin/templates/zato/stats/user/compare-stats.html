{% extends "zato/index.html" %}
{% load extras %}
{% block html_title %}User defined statistics{% endblock %}

{% block "extra_css" %}

    <link rel="stylesheet" media="screen" href="/static/css/chosen.css" />
    <link rel="stylesheet" media="screen" href="/static/css/stats-user.css" />

{% endblock %}

{% block "extra_js" %}

<script type="text/javascript" src="/static/frappe-charts/frappe-charts.min.iife.js"></script>
<script type="text/javascript" src="/static/chosen/chosen.jquery.js"></script>
<script type="text/javascript" src="/static/js/common.js"></script>

<script>
    $.fn.zato.data_table.get_columns = function() {
        return [
            '_numbering',
            '_selection',

            'name',
            'description',
        ]
    };

    $(document).ready(function(){

        $("#category-select").chosen({
        });

        $("#subcategory-select").chosen({
        });

        $("#user-select").chosen({
            "width":230,
            "multiple":true,
        });

    });

</script>
{% endblock %}

{% block "content" %}
<h2 class="zato">User defined statistics</h2>

{% if not zato_clusters %} {% include "zato/no-clusters.html" %} {% else %}

<div id="user-message-div" style='display:none'><pre id="user-message" class="user-message"></pre></div>

{% if cluster_id %}

<div id="markup">

    <div style="text-align: cente2r !important;">
    <br/>

    <h3>Compare results</h3>
    <br/>

    <table id="data-table" style="width:70%; margin: auto">

        <thead>
            <tr>
                <td colspan="8">

                    <div id="chart1">
                    </div>
                    <div id="chart2"></div>
                    <div id="chart3"></div>
                    <div id="chart4"></div>


                    <script>

                        // ////////////////////////////////////////////////////////////////////////////////////////

                        const data = {

                            Typeels:
                            [
                             1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                             21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
                             41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60
                            ],

                            yMarkers: [{
                                Typeel: "Max. score",
                                value: 40,
                                options: { TypeelPos: 'left' } // default: 'right'
                                }
                            ],

                            datasets: [
                                {
                                    name: "zzz@example.com", type: "line",
                                    values: [6, 9, 14, 17, 23, 33, 40]
                                },

                                {
                                    name: "janet.smith@example.com", type: "line",
                                    values: [6, 9, 11, 12, 14, 17, 23, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 29, 33, 35, 40]
                                },
                                {
                                    name: "james.doe@example.com", type: "line",
                                    values: [
                                        2, 2, 2, 2,
                                        2, 2, 2, 2,
                                        15, 15,
                                        19, 19, 19, 19,
                                        19, 19, 19, 19,
                                        19, 19, 19, 19,
                                        27, 33, 33, 33,
                                ]
                                },
                            ]
                        }

                        const chart = new frappe.Chart("#chart1", {
                            title: "Item Type Score",
                            data: data,
                            type: 'line', // or 'bar', 'line', 'scatter', 'pie', 'percentage', 'axis-mixed'
                            colors: ['#009900', '#6666ff', '#ff6666'],
                            xvaluesOverPoints: 1,
                            isNavigable: true,
                            showLegend: 0,
                            truncateLegends: true,

                            axisOptions: {
                                xAxisMode: 'span',
                                yAxisMode: 'span',
                                xIsSeries: true
                            },
                            barOptions: {
                                spaceRatio: 2 // default: 1
                            },
                            lineOptions: {
                                dotSize: 2,
                                //regionFill: 1,
                                spline: 0,
                                hideDots: false,
                            },
                            tooltipOptions: {
                                formatTooltipX: d => d + ' min.',
                                formatTooltipY: d => (d || '40') + ' pts.' ,
                            }
                        });

                    </script>

                </td>
            </tr>
        </thead>

        <thead>
            <tr class='ignore'>
                <td colspan="3" style="text-align: left;">
                    ‚Üê <a href="#">Back to main page </a>
                </td>
                <td colspan="5" style="text-align: right;">
                    <select>
                        <option>---</option>
                        <option>One week</option>
                        <option>One month</option>
                        <option>One year</option>
                        <option>All</option>
                    </select>
                    <select>
                        <option>---</option>
                        <option>All types</option>
                        <option>Type 1</option>
                        <option>Type 2</option>
                        <option>Type 3</option>
                    </select>
                    <select>
                        <option>---</option>
                        <option>Subtype 1</option>
                        <option>Subtype 2</option>
                        <option>Subtype 3</option>
                        <option>Subtype 4</option>
                    </select>
                    <select>
                        <option>---</option>
                        <option>user1@example.com</option>
                        <option>user2@example.com</option>
                        <option>user3@example.com</option>
                    </select>
                    <input type="button" value="List" onclick="location.href='?cluster_id={{ cluster_id }}&amp;action=BrowseStats'"/>
                    <input type="button" value="Display" onclick="location.href='?cluster_id={{ cluster_id }}&amp;action=DisplayStats'"/>
                    <input type="button" value="Compare" onclick="location.href='?cluster_id={{ cluster_id }}&amp;action=CompareStats'"/>
                </td>
            </tr>
        </thead>
        <thead>
            <tr class='ignore'>
                <th><input type="checkbox" /></th>
                <th>&nbsp;</th>

                <th style="text-align: left;"><a href="#">Start time</a></th>
                <th style="text-align: left;"><a href="#">Type</a></th>
                <th style="text-align: left;"><a href="#">User</a></th>
                <th style="text-align: left;"><a href="#">Details</a></th>
                <th style="text-align: right;"><a href="#">Success</a></th>
                <th style="text-align: right;"><a href="#">Progress</a></th>
        </thead>

        <tbody>
            {% if items %} {% for item in items %}
            <tr class="{% cycle 'odd' 'even' %}" id='tr_{{ item.id }}'>
                <td><input type="checkbox" /></td>
                <td class='numbering' style="width:10px">&nbsp;</td>

                <td style="text-align: left; width:15%">{{ item.date_started }}</td>

                <td style="text-align: left; width:15%">{{ item.Type_type }}</td>

                <td style="text-align: left;"><a class="stats" href="?cluster_id={{ cluster_id }}&amp;action=BrowseStats&amp;item_id={{ item.id }}">{{ item.username }}</a></td>

                <td style="text-align: left;">
                    <span class="description">
                    </span>
                </td>
                <td style="text-align: center;">
                    <span class="description" style="font-size: 1.2em !important;">
                    </span>
                </td>
                <td style="text-align: center;">
                    <a href="#">Display</a>
                </td>
            </tr>
            {% endfor %} {% else %}
            <tr class='ignore'>
                <td colspan='4'>No results</td>
            </tr>
            {% endif %}

        </tbody>
    </table>

    <br/>
    <br/>



    </div>
</div>

{% endif %} {% comment %}cluster_id{% endcomment %}

{% endif %}{% comment %}not zato_clusters{% endcomment %} {% endblock %}
